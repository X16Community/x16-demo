5 REM BALLS...A SLIGHTLY MODIFIED VERSION OF
6 REM THE ONE SHOWN IN DAVID'S VIDEO. I HOPE HE DON'T MIND.
10 SCREEN 0
20 PRINT"NUMBER OF BALLS (1-255)?"
30 INPUT N
40 IF N<1 OR N>255 THEN 20
60 PRINT CHR$(147);
70 DIM BX(N):DIM BY(N):DIM BC(N)
75 DIM DX(N):DIM DY(N)
80 FOR B=0TON
90 BX(B)=INT(RND(1)*40)*2+1
100 BY(B)=INT(RND(1)*30)*256
105 BC(B)=INT(RND(1)*14)+1
106 DX(B)=INT(RND(1)*2)
108 REM DY(B)=INT(RND(1)*2)
109 DY(B)=1
110 NEXT B
120 REM
130 FORY=0TO29:FORX=0TO39
140 Q=Y*256+X*2
150 VPOKE0,Q,81:VPOKE0,Q+1,0
160 NEXTX,Y
200 FOR B=1TON
210 VPOKE0,BY(B)+BX(B),0
230 DXB=DX(B)
240 IFDXB=0THENGOSUB1010
250 IFDXB=1THENGOSUB1040
255 DYB=DY(B)
260 IFDYB=0THENGOSUB1070
270 IFDYB=1THENGOSUB1100
280 VPOKE0,BY(B)+BX(B),BC(B)
290 NEXTB
300 GOTO 200
1000 REM
1010 BXB=BX(B)
1011 IFBXB=1THENDX(B)=1:RETURN
1020 BX(B)=BXB-2:RETURN
1030 REM
1040 BXB=BX(B)
1041 IFBXB=79THEN BX(B)=77:DX(B)=0:RETURN
1050 BX(B)=BXB+2:RETURN
1060 REM
1070 BYB=BY(B)
1071 IFBYB=0THENDY(B)=1:RETURN
1080 BY(B)=BYB-256:RETURN
1090 REM
1100 BYB=BY(B)
1101 IFBYB=7424THENBY(B)=7168:DY(B)=0:RETURN
1110 BY(B)=BYB+256:RETURN
